{% extends "base.html" %}
{% block title %}Edit {{profile.user.username}}'s profile{% endblock %}

{% block content %}
{% if profile.member %}
You are currently a supporter; your membership expires on {{profile.membershipExpiry}}.
{% else %}

{% endif %}
<form action="{% url accounts_edit_profile %}" method="post">{% csrf_token %}
{{ pForm.as_p }}
<input type="submit" value="Save profile" id="saveProfile"/>
</form>

<p style="font-size: 75%;">
    <a href="/accounts/password/change">Password change form</a>
</p>
<script type="text/javascript">
  $(document).ready(function() {
    var addlData;
    try {
      addlData = JSON.parse("{{profile.additional_data|escapejs}}");
    } catch (e) {
      addlData = {disableChat: false};
    }
    $("#id_profileText").val("{{profile.profile|escapejs}}");
    $("#id_defaultLexicon option[value='{{profile.defaultLexicon.pk}}']").prop('selected', true);
    $('<div>Enter up to 2000 characters of information about yourself to show on your profile. You may use <a href="http://en.wikipedia.org/wiki/Markdown" target="_blank">Markdown</a>.</div>').insertBefore($("label[for='id_profileText']"))
    $('#id_disableChat').prop('checked', addlData.disableChat);
  });
  $("#id_profileText").css({'height': '300px', 'width': '500px'});
  $("#saveProfile").button();
</script>

{% endblock %}